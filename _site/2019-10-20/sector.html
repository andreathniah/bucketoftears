<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>SecTor 2019 | Bucket of Tears</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="SecTor 2019" />
<meta name="author" content="BoT" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SecTor is one of Canada’s biggest security conference and I was lucky enough to snag a ticket from OWASP Toronto Chapter." />
<meta property="og:description" content="SecTor is one of Canada’s biggest security conference and I was lucky enough to snag a ticket from OWASP Toronto Chapter." />
<link rel="canonical" href="https://bucketoftears.netlify.app/2019-10-20/sector" />
<meta property="og:url" content="https://bucketoftears.netlify.app/2019-10-20/sector" />
<meta property="og:site_name" content="Bucket of Tears" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-20T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SecTor 2019" />
<script type="application/ld+json">
{"@type":"BlogPosting","description":"SecTor is one of Canada’s biggest security conference and I was lucky enough to snag a ticket from OWASP Toronto Chapter.","mainEntityOfPage":{"@type":"WebPage","@id":"https://bucketoftears.netlify.app/2019-10-20/sector"},"url":"https://bucketoftears.netlify.app/2019-10-20/sector","author":{"@type":"Person","name":"BoT"},"headline":"SecTor 2019","dateModified":"2019-10-20T00:00:00+08:00","datePublished":"2019-10-20T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="https://bucketoftears.netlify.app/feed.xml" title="Bucket of Tears" />

  <!-- Google Analytics-->
  
</head>


  <body>

    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">Bucket of Tears</h2>
    </a>
    <ul>
      <li><a href="/">Posts</a></li>
      <li><a href="/tags">Tags</a></li>
      <li><a href="/about">About</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        BoT
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2019-10-20 00:00:00 +0800">October 20, 2019</time>
    
  </div>

  <h1 class="post-title">SecTor 2019</h1>
  <div class="post-line"></div>

  <p>SecTor is one of Canada’s biggest security conference and I was lucky enough to snag a ticket from <a href="https://owasp.org/www-chapter-toronto/">OWASP Toronto Chapter</a>.</p>

<p>It is also the first security event that I went together with folks from @ecobee. Lee – my super supportive boss – even had extra tickets for me to participate in the after-party. Unfortunately, I had classes that night. Boooooooo!!</p>

<h2 id="sector-2019-ctf">SecTor 2019 CTF</h2>

<p><strong>Event name</strong>: SecTor 2019<br />
<strong>Location</strong>: Metro Toronto Convention Centre<br />
<strong>Date</strong>: 09/10/2019 - 10/10/2019<br />
<strong>Team</strong>: Individual</p>

<p>Upon registration, all attendees are given a physical copy of a pocket guide that details the conference details. Looking closely at one of the pages, we can see that a CTF is totally taking place!</p>

<p><img src="../assets/201910_sector/0_physicalpocketguide.jpg" alt="0_physicalpocketguide" /></p>

<h3 id="flag-1">Flag 1</h3>

<p>Squinting at the far left of the image, we see a <code class="language-plaintext highlighter-rouge">base64</code> encoded string, <em>interesting</em>! Following the instructions on the page, I eventually found the <em>Nuix + Dolos Group</em> booth at Hall 700 and was given the link to the CTF platform: <a href="sectorctf2019.online">sector2019ctf.online</a>.</p>

<p>Here’s the cute entrance page we are greeted with!</p>

<p><img src="../assets/201910_sector/1_enterance.PNG" alt="1_enterance" /></p>

<p>We first started out by taking a quick look at the source code via developer tools. Oh hey an image was commented out! Accessing <code class="language-plaintext highlighter-rouge">sectorctf2019.online/images/2019_pocket_guide.png</code> led us to a blown up image of what we see in the physical guide book. Great! Now we can programmatically extract the <code class="language-plaintext highlighter-rouge">base64</code> text to decode them!</p>

<p><img src="../assets/201910_sector/1_inspectme.PNG" alt="1_inspectme" /></p>

<p><img src="../assets/201910_sector/1_pocketguide.png" alt="1_pocket_guide" /></p>

<p>Initially, we went through the long process of rotating the image, cropping the <code class="language-plaintext highlighter-rouge">base64</code> text and run them though an online <a href="https://www.onlineocr.net/">Optical Character Recognition tool</a>. We eventually realized that we can actually just open up the image as text (rename the <code class="language-plaintext highlighter-rouge">png</code> extension to <code class="language-plaintext highlighter-rouge">txt</code>, or plain old <code class="language-plaintext highlighter-rouge">strings</code> command) to grab the string. Simple!</p>

<p>Nevertheless, we got our string and here’s what is was decoded to:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo "QWxsIGZsYWdzIHdpbGwgYmUgdXNlIHRoZSBmb3JtYXQgJ1NlY1RvcltmbGFnXScuIEUuRy4gU2VjVG9yW1RoaXNfaXNfbjB0X2FfZmxhZ10=" | base64 --decode

All flags will be use the format 'SecTor[flag]'. E.G. SecTor[This_is_n0t_a_flag]
</code></pre></div></div>

<p>Aww man, it wasn’t a flag :(</p>

<p>But that’s okay, because clicking through other links on the webpage led us to your flag with the abovementioned flag format! Woohooo!</p>

<p><img src="../assets/201910_sector/1_flag.PNG" alt="1_flag" /></p>

<p><strong>Flag 1: SecTor[Go on till you come to the end, then stop.]</strong></p>

<h3 id="flag-2">Flag 2</h3>

<p>Based on the instructions on the first flag, we proceed to <code class="language-plaintext highlighter-rouge">sectorctf2019.online/knock/knock/packets.pcap</code> and were given a <a href="./source/packets.pcap"><code class="language-plaintext highlighter-rouge">pcap</code></a> file. As the extension suggests, its a <code class="language-plaintext highlighter-rouge">wireshark</code> file. Filtering the results for <code class="language-plaintext highlighter-rouge">http</code> and <code class="language-plaintext highlighter-rouge">http2</code>, we spotted something! It seems that our victim was trying to download an achieved file from <code class="language-plaintext highlighter-rouge">sectorctf2019.online/Doorknob.7z</code>.</p>

<p>Let’s try to download them via <code class="language-plaintext highlighter-rouge">wget</code>…</p>

<p><img src="../assets/201910_sector/2_wget.PNG" alt="2_wget" /></p>

<p>Nope, we got <code class="language-plaintext highlighter-rouge">404</code> status code. That’s fine because <code class="language-plaintext highlighter-rouge">wireshark</code> could totally help us achieve the same result since <code class="language-plaintext highlighter-rouge">wireshark</code> captured the complete file bytes of the 7zip file.</p>

<p>We can recreate this <code class="language-plaintext highlighter-rouge">zip</code> file by right clicking the highlighted bytes and select <code class="language-plaintext highlighter-rouge">Export Packet Bytes</code>. A cursory search on Google teaches us that <code class="language-plaintext highlighter-rouge">7z</code> is another form of <code class="language-plaintext highlighter-rouge">zip</code> file, unfortunately, unzipping via Linux command proves to be rather hard, so we went through the long route of transferring the file over to Windows, extract them, then return it back to our <code class="language-plaintext highlighter-rouge">Kali Linux</code> virtual machine.</p>

<p><img src="../assets/201910_sector/2_wireshark.PNG" alt="2_wireshark" /></p>

<p>Here comes the weird part – the extracted <code class="language-plaintext highlighter-rouge">Doorknob</code> file doesn’t run even with permissions granted via <code class="language-plaintext highlighter-rouge">chmod +x Doorknob</code>. So frustrating!</p>

<p>It was only after running the <code class="language-plaintext highlighter-rouge">file</code> command when we realized what went wrong – the environment we are running the file on!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Doorknob: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=b56ea019612628ce072f1a58c5708bcaad3d3934, not stripped
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Doorknob</code> here is says it runs on <code class="language-plaintext highlighter-rouge">x86-64</code>, perhaps our virtual machine is not of the same environment? The <code class="language-plaintext highlighter-rouge">uname -m</code> command revealed that our suspicion was right. <code class="language-plaintext highlighter-rouge">Kali Linux</code> runs on <code class="language-plaintext highlighter-rouge">i686</code>! Thank god we have an <code class="language-plaintext highlighter-rouge">Ubuntu</code> - which conveniently runs on the required environment - virtual machine at hand!</p>

<p>Yep, we got our flag!</p>

<p><img src="../assets/201910_sector/2_flag.PNG" alt="2_flag" /></p>

<p><strong>Flag 2: SecTor[No, I do mean impassible. Nothing’s impossible!]</strong></p>

<h3 id="flag-3">Flag 3</h3>

<p>Downloading <code class="language-plaintext highlighter-rouge">sectorctf2019.online/stage/B/binary.pdf</code>, we obtain a rather interesting <a href="./source/binary.pdf">PDF file</a> – we see a bunch of binary numbers!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>01010110 01101101 01001110 01110010 01001001 01000111 01010010 01110000 01100010 01101101
00110101 00110110 01100100 00110010 01001010 00110001 01001001 01000111 00111001 00110110

[TRUNCATED]

01101000 01110100 01011001 00110010 01010010 01111000 01001001 01000101 01100111 01100111
01011010 01101101 01010010 01111010 01001100 01100111 00111101 00111101
</code></pre></div></div>

<p>Converting these <code class="language-plaintext highlighter-rouge">binary</code> to <code class="language-plaintext highlighter-rouge">ascii</code> with space as the delimiter, we obtain a <code class="language-plaintext highlighter-rouge">base64</code> string which can further be decoded to the output shown below.</p>

<p><img src="../assets/201910_sector/3_binarybase64.PNG" alt="3_binarybase64" /></p>

<p>Hmm, the output doesn’t make sense. But it seems that this could be a <code class="language-plaintext highlighter-rouge">ROT13</code> cipher, given that its linguistic properties look awfully similar English’s structure. Going with that line of thought, we can identify words with single letters to be either <code class="language-plaintext highlighter-rouge">a</code> or <code class="language-plaintext highlighter-rouge">I</code>. The fact that different lines of single letter words are encoded in different letters suggests that each line might be wrapped with different values.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[TRUNCATED]
Rfc fsppgcp G em,
sgd adghmcdq H fds.
</code></pre></div></div>

<p>It turns out we were right, each line of this output requires a decreasing amount of wrap! Starting with <code class="language-plaintext highlighter-rouge">12</code> down to <code class="language-plaintext highlighter-rouge">1</code>, here’s the output we get:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>How puzzling all these chanes are!
I'm never sure what I'm going to be,
from one minute to another.
I don't see how he can ever finish[
if he doesn't begin]
The time has come, the walrus said
to tal, of many things[
Of shoes and ships ]
and sealig wax -
Password[Of c4bbag3s and k1ngs]
The hurrier I go,
the behinder I get.
</code></pre></div></div>

<p><em>Anddddd…</em> I officially gave up here. Let’s hope someone wrote a writeup about this challenge so I can figure out what I missed!</p>

</div>



<div class="pagination">
  
    <a href="/2021-06-21/oscp-review" class="left arrow">&#8592;</a>
  
  
    <a href="/2019-10-17/bsides-toronto" class="right arrow">&#8594;</a>
  

  <a href="#" class="top">Top</a>
</div>
    </main>

    <footer>
  <span>
    &copy; <time datetime="2021-07-01 21:08:40 +0800">2021</time> . Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer>

  </body>
</html>
