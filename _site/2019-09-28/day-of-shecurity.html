<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Day of Shecurity 2019 | Bucket of Tears</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Day of Shecurity 2019" />
<meta name="author" content="BoT" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="It has been a couple of months since I’ve step afoot into the land of raccoons Canada and I thought that is high time for me to immerse myself into the security community here at downtown Toronto." />
<meta property="og:description" content="It has been a couple of months since I’ve step afoot into the land of raccoons Canada and I thought that is high time for me to immerse myself into the security community here at downtown Toronto." />
<link rel="canonical" href="https://andreathniah.github.io/bucketoftears/2019-09-28/day-of-shecurity" />
<meta property="og:url" content="https://andreathniah.github.io/bucketoftears/2019-09-28/day-of-shecurity" />
<meta property="og:site_name" content="Bucket of Tears" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-09-28T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Day of Shecurity 2019" />
<script type="application/ld+json">
{"@type":"BlogPosting","description":"It has been a couple of months since I’ve step afoot into the land of raccoons Canada and I thought that is high time for me to immerse myself into the security community here at downtown Toronto.","mainEntityOfPage":{"@type":"WebPage","@id":"https://andreathniah.github.io/bucketoftears/2019-09-28/day-of-shecurity"},"url":"https://andreathniah.github.io/bucketoftears/2019-09-28/day-of-shecurity","author":{"@type":"Person","name":"BoT"},"headline":"Day of Shecurity 2019","dateModified":"2019-09-28T00:00:00+08:00","datePublished":"2019-09-28T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/bucketoftears/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/bucketoftears/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/bucketoftears/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/bucketoftears/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="https://andreathniah.github.io/bucketoftears/feed.xml" title="Bucket of Tears" />

  <!-- Google Analytics-->
  
</head>


  <body>

    <nav class="nav">
  <div class="nav-container">
    <a href="/bucketoftears/">
      <h2 class="nav-title">Bucket of Tears</h2>
    </a>
    <ul>
      <li><a href="/bucketoftears/">Posts</a></li>
      <li><a href="/bucketoftears/tags">Tags</a></li>
      <li><a href="/bucketoftears/about">About</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        BoT
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2019-09-28 00:00:00 +0800">September 28, 2019</time>
    
  </div>

  <h1 class="post-title">Day of Shecurity 2019</h1>
  <div class="post-line"></div>

  <p>It has been a couple of months since I’ve step afoot into <del>the land of raccoons</del> Canada and I thought that is high time for me to immerse myself into the security community here at downtown Toronto.</p>

<p>Day of Shecurity is one of the very first event that I participated in and had tons of fun working on the CTF with folks I’ve met there.</p>

<p>Here’s some of the challenges writeup.</p>

<h2 id="flag-queen-2019">Flag Queen 2019</h2>

<p><strong>Event name</strong>: Day of Shecurity Toronto 2019<br />
<strong>Location</strong>: George Brown College<br />
<strong>Date</strong>: 14/09/2019 - 18/09/2019<br />
<strong>Team</strong>: BoT</p>

<p><img src="../assets/201909_shecurity/Results.PNG" alt="Results" /></p>

<h3 id="flag-queen-veni-vidi-vici">[Flag Queen] Veni, vidi, vici</h3>

<p>Upon registration, all participants receive a card that looks like this.</p>

<p><img src="../assets/201909_shecurity/FlagQueen.png" alt="FlagQueen" /></p>

<p>The line at the bottom looks weird but <code class="language-plaintext highlighter-rouge">://</code> and <code class="language-plaintext highlighter-rouge">.klm/</code> was a dead giveaway that it was a URL link. <code class="language-plaintext highlighter-rouge">ROT13 cipher</code> easily reveal <code class="language-plaintext highlighter-rouge">uggcf://qnlbsfurphevgl.klm</code> to be <code class="language-plaintext highlighter-rouge">https://dayofshecurity.xyz</code></p>

<p><strong>Flag: https://dayofshecurity.xyz</strong></p>

<h3 id="web-oh-yes-little-bobby-tables-we-call-him">[Web] Oh, yes. Little Bobby Tables we call him</h3>

<blockquote>
  <p>The backend devs of this Super Secure Site (TM) thought they’d protected their users’ personal data. But, they’ve missed some things.</p>

  <p>First you find the data, then you get the points, then you get the power.</p>

  <p>https://chmodxx.net/dos</p>
</blockquote>

<p>With the challenge named <a href="https://xkcd.com/327/">Little Bobby</a>, there was little to no doubt that this challenge requires some form of SQL injection. With that in mind, I did a quick survey on the website in general. It only consist of a normal login page with some form of validation being enforced. Poking around, I noticed that any attempt to submit data from the frontend would have their data sanitized with the <code class="language-plaintext highlighter-rouge">serialize()</code> command.</p>

<p><img src="../assets/201909_shecurity/BobbyTables_Javascript.PNG" alt="BobbyTables_Javascript" /></p>

<p>Nevertheless, I tried the usual SQL injection statement to see if the login form is vulnerable. Lo and behold, it is. Now that I know that the site vulnerable from the frontend attack vector, I proceed to check the backend too.</p>

<p><img src="../assets/201909_shecurity/BobbyTables_FatalError.PNG" alt="BobbyTables_FatalError" /></p>

<p>Copying the request I made from the <code class="language-plaintext highlighter-rouge">Network</code> panel as a <code class="language-plaintext highlighter-rouge">curl</code> request, I tried submitting <code class="language-plaintext highlighter-rouge">'1 or 1=1--</code> as the injection statement. Nope, that didn’t work out – I got the same fatal error as above. When I changed the injection statement to <code class="language-plaintext highlighter-rouge">' or 1=1--</code> though, I got something different, which unfortunately, is not the flag. <em>Whyyyyy?</em></p>

<p><img src="../assets/201909_shecurity/BobbyTables_Failcurl.PNG" alt="BobbyTables_Failcurl" /></p>

<p><img src="../assets/201909_shecurity/BobbyTables_Successfulcurl.PNG" alt="BobbyTables_curl" /></p>

<p>The answer lies in how the <code class="language-plaintext highlighter-rouge">curl</code> request was constructed. The <code class="language-plaintext highlighter-rouge">curl</code> I used contains a <code class="language-plaintext highlighter-rouge">Cookie</code> value specific to the browser session hence even if the injection were successful, I wouldn’t have been able to see anything within the terminal. I actually needed to go back to my browser that <em>hasn’t been closed</em> and <em>refresh</em> the page to see the flag!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl "https://chmodxx.net/dos/submit.php"
	[TRUNCATED]
-H "Cookie: PHPSESSID=5uj69calgmr27fk839lo33hc80" -H "Connection: keep-alive" -H "DNT: 1" --data "email=%27%20or%201%3D1--&amp;password=sadfsdf" --compressed
</code></pre></div></div>

<p><img src="../assets/201909_shecurity/BobbyTables_Admin.PNG" alt="BobbyTables_Admin" /></p>

<p><strong>Flag: {FLAG:AND1HOPEUVELEARNED2SANITIZEYOURINPUT5}</strong></p>

<h3 id="hunting-easter-egg-hunt">[Hunting] Easter Egg Hunt</h3>

<blockquote>
  <p>I wonder what else is going on on this vserver…</p>

  <p>You’ll learn some useful skills for this challenge at “Reversing and Exploring The World of Mobile Apps: Android APKs”</p>

  <p>URL: <a href="https://dayofshecurity.xyz">https://dayofshecurity.xyz</a></p>
</blockquote>

<p>Googling <code class="language-plaintext highlighter-rouge">vserver</code> reveals that this is just a term for virtual private server like Digital Ocean, Heroku etc. With the challenge description in mind, I went ahead to do a reverse lookup on the URL given via <a href="https://www.shodan.io/host/142.93.151.96">Shodan.io</a>.</p>

<p>Right off the bat, I saw something interesting - the IP address <code class="language-plaintext highlighter-rouge">142.93.151.96</code> actually has its hostname set as <code class="language-plaintext highlighter-rouge">y2mk.cc</code>. Several ports are also opened: 22, 80, 443, 8443. This result coincides with what I would see if I were to run <a href="../assets/201909_shecurity/y2mk.nmap">nmap</a> using <code class="language-plaintext highlighter-rouge">nmap -sc -sV -oA y2mk 142.93.151.96</code></p>

<p>Visiting <code class="language-plaintext highlighter-rouge">y2mk.cc</code> tells me that I am on the correct path:</p>

<blockquote>
  <p>You’re halfway there!</p>

  <p>Yep, you’ve found something else on this vserver but you’re not quite there yet.</p>
</blockquote>

<p>Here comes the confusing part - <code class="language-plaintext highlighter-rouge">curl</code> commands.</p>

<p><code class="language-plaintext highlighter-rouge">curl -i 142.93.151.96:443</code> returns a <code class="language-plaintext highlighter-rouge">400 Bad Request</code> because <code class="language-plaintext highlighter-rouge">The plain HTTP request was sent to HTTPS port</code>. This was weird, given that <code class="language-plaintext highlighter-rouge">nmap</code> clearly tells says that I should be seeing what <code class="language-plaintext highlighter-rouge">y2mk.cc</code> displays - after all, the value of <code class="language-plaintext highlighter-rouge">http-title</code> is <code class="language-plaintext highlighter-rouge">Halfway there</code>.</p>

<p><img src="../assets/201909_shecurity/EasterEggHunt_nmap_443&amp;8443.PNG" alt="EasterEggHunt_nmap_443&amp;8443" /></p>

<p>What is going on here? The key lies in how web-servers serves their content. In the current internet where multiple domains can exist in one IP address, there is a need for servers like <code class="language-plaintext highlighter-rouge">nginx</code> to be able to serve different contents to different domain names. How this is carried out is done via the <code class="language-plaintext highlighter-rouge">host</code> attribute in the request header.</p>

<p>One thing to note is that in <em>this</em> server, IP address and domain names are considered to be different thing - despite resolving into the same thing - and hence will serve different content. This makes sense considering the previous <code class="language-plaintext highlighter-rouge">curl</code> error message says the server would port forward any request to <code class="language-plaintext highlighter-rouge">https</code>. Inputting <code class="language-plaintext highlighter-rouge">https://y2mk.cc:8443</code> as the curl parameter would have revealed the flag.</p>

<p><img src="../assets/201909_shecurity/EasterEggHunt_IPcurl.PNG" alt="EasterEggHunt_IPcurl" /></p>

<p><img src="../assets/201909_shecurity/EasterEggHunt_DomainCurl.PNG" alt="EasterEggHunt_DomainCurl" /></p>

<p><strong>Flag: Please don’t portscan other people’s servers.</strong></p>

<h3 id="forensics-not-quite-a-stego-sauras">[Forensics] Not Quite A Stego-sauras</h3>

<blockquote>
  <p><a href="">flag.png</a></p>
</blockquote>

<p>A simple <code class="language-plaintext highlighter-rouge">ls -la</code> showed that the image file contains <code class="language-plaintext highlighter-rouge">36382</code> bytes and that’s <em>huge</em>. Unfortunately, <code class="language-plaintext highlighter-rouge">file flag.png</code> doesn’t reveal anything amiss – what about <code class="language-plaintext highlighter-rouge">binwalk</code>?</p>

<p><img src="../assets/201909_shecurity/Stegosauras_Binwalk.PNG" alt="Stegosauras_Binwalk" /></p>

<p>Seems that a <code class="language-plaintext highlighter-rouge">zip</code> file is hidden behind the <code class="language-plaintext highlighter-rouge">png</code> image, how sneaky. Unzipping it gave me the image containing the flag.</p>

<p><strong>Flag: {flag-some_bytes_are_magical}</strong></p>

<h3 id="forensics-an-image-is-worth-16-kilobits">[Forensics] An Image is Worth 16 Kilobits</h3>

<blockquote>
  <p><a href="">image.jpg</a></p>
</blockquote>

<p>Same as before, <code class="language-plaintext highlighter-rouge">ls -la</code> reveals that this is definitely a case of steganography. This time, I used <code class="language-plaintext highlighter-rouge">file image.jpg</code> just to check if the file type is as what the filename claims to be, and oh, something looks interesting.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>image.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, comment: "e2ZsYWc6NjFhM2NlNDlmYTAyMjkwZjIyYzc1MmM2YjRiZmZiZmRmY2FhYTQ3NDI4NTc4MWU1N30K", progressive, precision 8, 1500x1525, frames 3
</code></pre></div></div>

<p>That looks like a <code class="language-plaintext highlighter-rouge">base64</code> in the comment section. Decoding via command line gave me the flag, yay!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ echo "e2ZsYWc6NjFhM2NlNDlmYTAyMjkwZjIyYzc1MmM2YjRiZmZiZmRmY2FhYTQ3NDI4NTc4MWU1N30K" | base64 --decode

{flag:61a3ce49fa02290f22c752c6b4bffbfdfcaaa474285781e57}
</code></pre></div></div>

<p><strong>Flag: {flag:61a3ce49fa02290f22c752c6b4bffbfdfcaaa474285781e57}</strong></p>

<h3 id="forensics-reversing-101">[Forensics] Reversing 101</h3>

<blockquote>
  <p>The challenge category is accurate.</p>

  <p><a href="">flag.jpg</a></p>
</blockquote>

<p>I quite like this challenge although it took me more than half a day to realize that the clue was literal.</p>

<p>I started off by using <code class="language-plaintext highlighter-rouge">file</code> to determine the file type. The command returns a <code class="language-plaintext highlighter-rouge">flag.jpg: data</code> which the <a href="http://man7.org/linux/man-pages/man1/file.1.html">man page</a> of the <code class="language-plaintext highlighter-rouge">file</code> command clarifies that it cannot identify the contents. This lead me to investigate the hex dump of the file using <code class="language-plaintext highlighter-rouge">xxd flag.png | head</code>. We can see that the hex starts of with the consistent pattern of <code class="language-plaintext highlighter-rouge">...(</code></p>

<p><img src="../assets/201909_shecurity/Reversing101_xxd_flag_head.PNG" alt="Reversing101_xxd_flag_head" /></p>

<p>This clearly meant that the file in question is not a <code class="language-plaintext highlighter-rouge">jpg</code> file – or anything type of file in fact. A proper image file such as this type should have the following sequences:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>00000000: ffd8 ffe0 0010 4a46 4946 0001            ......JFIF..
</code></pre></div></div>

<p><img src="../assets/201909_shecurity/Reversing101_xxd_flag_tail.PNG" alt="Reversing101_xxd_tail" /></p>

<p>It was only when I printed out the tails of the hex dump when I noticed something <em>realllyyy</em> interesting. The bytes are actually reversed! Rearranging <code class="language-plaintext highlighter-rouge">FIFJ......</code> would become <code class="language-plaintext highlighter-rouge">......JFIF</code>, the proper sequence of a <code class="language-plaintext highlighter-rouge">jpg</code> file. Wow.</p>

<p>So here’s a quick python script to reverse each of the bytes in the <code class="language-plaintext highlighter-rouge">flag.jpg</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag.jpg"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
	<span class="n">bytes_rev</span> <span class="o">=</span> <span class="sa">b</span><span class="s">""</span>
    <span class="n">bytes_read</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">while</span> <span class="n">bytes_read</span><span class="p">:</span>
        <span class="c1"># read all items in the array, reversed
</span>        <span class="n">bytes_rev</span> <span class="o">+=</span> <span class="n">bytes_read</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">bytes_read</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"reversed.jpg"</span><span class="p">,</span> <span class="s">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">newfile</span><span class="p">:</span>
        <span class="n">newfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">bytes_rev</span><span class="p">)</span>
</code></pre></div></div>

<p>Run the script and a new file <a href="./source/reversing101/reversed.jpg">reversed.jpg</a> would be created. This is the flag!</p>

<p><strong>Flag: {flag-into_to_reversing}</strong></p>

<h3 id="forensics-kittyforensics">[Forensics] KittyForensics</h3>

<blockquote>
  <p>Why is he sad :( ? binwalk, sleuthkit is valuable here.</p>

  <p><a href="">shecurity.img</a></p>
</blockquote>

<p>I start off with using <code class="language-plaintext highlighter-rouge">fls shecurity.img</code> to recursively list all files and directories and determine what was within and what has been deleted from <code class="language-plaintext highlighter-rouge">img</code> file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>d/d 11: lost+found
r/r * 12:       happy_kitten.jpg
r/r 13: lonelykitten.png
r/r 14: message.txt
V/V 2513:       $OrphanFiles
</code></pre></div></div>

<p>From the asterisk, I know that <code class="language-plaintext highlighter-rouge">happy_kitten.jpg</code> at <code class="language-plaintext highlighter-rouge">inode</code> 12 had been deleted. Unfortunately, recovering it with <code class="language-plaintext highlighter-rouge">sleuthkit</code> via <code class="language-plaintext highlighter-rouge">icat shecurity.img 12 &gt; happy_kitten.png</code> gave me an empty file – literally zero bytes.</p>

<p>That said, recovering <code class="language-plaintext highlighter-rouge">lonelykitten.png</code> and <code class="language-plaintext highlighter-rouge">message.txt</code> shows me some interesting things. First of all, the size of <code class="language-plaintext highlighter-rouge">lonelykitten.png</code> is huge - a whooping <code class="language-plaintext highlighter-rouge">2451544</code> bytes. Neither <code class="language-plaintext highlighter-rouge">binwalk</code> nor <code class="language-plaintext highlighter-rouge">file</code> reveal anything amiss. It was a PNG image, 1920 x 1080. Maybe it’s just huge? <em>Yes it was just huge</em>.</p>

<p>The content of <code class="language-plaintext highlighter-rouge">message.txt</code> does give me some context for <code class="language-plaintext highlighter-rouge">lonelykitten.png</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The kitten is sad because he lost his friend.

The half of the answer:
"SearchingFor"
</code></pre></div></div>

<p>Maybe the answer eludes to <code class="language-plaintext highlighter-rouge">steghide</code>? Nope, no success even with <code class="language-plaintext highlighter-rouge">steghide extract -sf lonelykitten.png -p "SearchingFor"</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>steghide: the file format of the file "lonelykitten.png" is not supported.
</code></pre></div></div>

<p>Aww man, what’s going on? Googling around, I realized that maybe <code class="language-plaintext highlighter-rouge">foremost</code> might be what I need, given that I must to crave out <code class="language-plaintext highlighter-rouge">lonelykitten.png</code> to find out what’s wrong with it. With the command <code class="language-plaintext highlighter-rouge">foremost shecurity.img</code>, I obtained an folder called <code class="language-plaintext highlighter-rouge">output</code>. Lo and behold, traversing down the folder brings me to <code class="language-plaintext highlighter-rouge">00016546.jpg</code> that clearly says: <code class="language-plaintext highlighter-rouge">Second part is "Teefies"</code></p>

<p><img src="../assets/201909_shecurity/KittyForensics_HappyKitten.jpg" alt="KittyForensics_HappyKitten" /></p>

<p>Concatenating both parts of the message would reveal the flag: <code class="language-plaintext highlighter-rouge">SearchingForTeefies</code></p>

<p><strong>Flag: SearchingForTeefies</strong></p>

<h3 id="crypto-all-your-base-are-belong-to-us">[Crypto] All Your Base Are Belong To Us</h3>

<blockquote>
  <p><a href="">flag.py</a></p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/"</span>
    <span class="n">r</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">p</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">+=</span> <span class="s">'='</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">'</span><span class="se">\0</span><span class="s">'</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">[(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">63</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="mi">6</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">),</span> <span class="n">n</span><span class="o">&amp;</span><span class="mi">63</span><span class="p">]</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">alpha</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span> <span class="o">+</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">raise</span> <span class="nb">NotImplementedError</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="s">'E2zSywCTCxvPDgvFDgHLx2fSCgHHyMv0Fq=='</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter flag: "</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">encode</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span> <span class="o">==</span> <span class="n">flag</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Correct! Good job."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Incorrect."</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>Solved by my teammate, I thought that this was rather ingenious, given that I was scared away by the large amount of foreign looking codes in this flag file.</p>

<p>From the <code class="language-plaintext highlighter-rouge">main()</code> function, I can see that a <code class="language-plaintext highlighter-rouge">flag</code> variable is being initialized as:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>E2zSywCTCxvPDgvFDgHLx2fSCgHHyMv0Fq==
</code></pre></div></div>

<p>Given the <code class="language-plaintext highlighter-rouge">==</code> at the back of the string, I now know that this is a <code class="language-plaintext highlighter-rouge">base64</code> encoded string. However, gibberish was returned when I attempted to convert them into text. From the challenge title, it seems that the operation used in this decoding was customized since the title claimed that the <em>“base belongs to them”</em>. I see that this is true from line 2 where <code class="language-plaintext highlighter-rouge">alpha</code> is initialized as:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/
</code></pre></div></div>

<p>Using that as the formula, the values was then pumped into a <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('',true)">base64 decoder</a> to get the flag.</p>

<p><img src="../assets/201909_shecurity/BaseBelongsToUs_flag.PNG" alt="BaseBelongsToUs_flag" /></p>

<p><strong>Flag: {flag-quite_the_alphabet}</strong></p>

<h3 id="crypto-le-chiffre">[Crypto] Le Chiffre</h3>

<blockquote>
  <p><a href="">flag.py</a></p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">string</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s">'shecurity'</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># array of lowercase characters where 0 = a, 1 = b, ... , 25 = z
</span>    <span class="n">a</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span>

    <span class="c1"># loop through user input character by character
</span>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plaintext</span><span class="p">:</span>
      <span class="c1"># if the character is a lowercase ascii character
</span>      <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="c1"># m1 = the index of the character from user input in the lowercase alphabet
</span>        <span class="n">m1</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="c1"># k1 = the index of the key character in the alphabet
</span>        <span class="n">k1</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)])</span>
        <span class="c1"># ciphertext index becomes the index of the user input character + the index of the key, mod 26
</span>        <span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span> <span class="o">+</span> <span class="n">k1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span>
        <span class="c1"># convert index to character
</span>        <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="c1"># not a lowercase ascii character, leave as-is
</span>      <span class="k">else</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">p</span>
        <span class="n">ciphertext</span> <span class="o">+=</span> <span class="n">c</span>
    <span class="k">return</span> <span class="n">ciphertext</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="s">'{xsei-nym_cmq_vj_elpxmm}'</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter flag: "</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span> <span class="o">==</span> <span class="n">flag</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Correct! Good job."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Incorrect."</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>Solved by a teammate, the challenge names directs me to the <code class="language-plaintext highlighter-rouge">Le Chiffre cipher</code>, also known as the <code class="language-plaintext highlighter-rouge">Vigenère cipher</code>. Using an <a href="https://cryptii.com/pipes/vigenere-cipher">online tool</a> with <code class="language-plaintext highlighter-rouge">shecurity</code> as the key and <code class="language-plaintext highlighter-rouge">{xsei-nym_cmq_vj_elpxmm}</code> as the cipher-text, the flag is obtained.</p>

<p><img src="../assets/201909_shecurity/LeChiffre_flag.PNG" alt="LeChiffre_flag" /></p>

<p><strong>Flag: {flag-the_joy_of_crypto}</strong></p>

<h3 id="crypto-xoruteforce">[Crypto] XORuteforce</h3>

<blockquote>
  <p>Alice and Barbara are writing cryptic messages for each other. Barbara’s trashcan has a left over of a torn paper that reads :</p>

  <table>
    <tbody>
      <tr>
        <td>~cidb?%Uwlsdf</td>
        <td>%Lv%D%H</td>
        <td>qmx</td>
      </tr>
    </tbody>
  </table>

  <p>Guess the key , break the cipher, reveal the flag !</p>
</blockquote>

<p>The challenge title literally directed me to carry out XOR brute force operation. <a href="https://gchq.github.io/CyberChef/">Online tools</a> are rather handy for this type of operations.</p>

<p><img src="../assets/201909_shecurity/XORuteforce.PNG" alt="XORuteforce" /></p>

<p><strong>Flag: {flag: Privacy Is A Myth}</strong></p>

<h3 id="misc-teelx">[Misc] TeelX</h3>

<blockquote>
  <p>Beep Boop</p>

  <p><a href="">TeeIX.wav</a></p>
</blockquote>

<p>Given that this is an audio steganography (<em>coz what else can it be</em>), I first thought that it might be SSTV related. So I played the audio out in the open and started recording with a tried-and-trusted mobile app, <code class="language-plaintext highlighter-rouge">Robot36</code>.</p>

<p><img src="../assets/201909_shecurity/TeelX_Robot36.jpg" alt="TeelX_Robot36" /></p>

<p>Nope, the main display didn’t convert into an image, but what’s interesting is the bottom right panel where I can see a series of dots. That brings me to pump the audio into <code class="language-plaintext highlighter-rouge">Sonic Visualiser</code> and I added a spectrogram into the audio via <code class="language-plaintext highlighter-rouge">Pane &gt; Add Spectrogram</code>.</p>

<p><img src="../assets/201909_shecurity/TeelX_SonicVisualiser.PNG" alt="TeelX_SonicVisualiser" /></p>

<p>Given the lack of dots and dashes, I ruled out Morse code. Playing the audio multiple times though, I came to realize that it sounded suspiciously similar to the touch tone dialing sequence we had in our pre-smartphone era (<em>thank god I’m not that young</em>). Googling brings me to the term <a href="https://en.wikipedia.org/wiki/Dual-tone_multi-frequency_signaling">Dual Tone Multi Frequency (DTMF)</a>. Isolating the tone <a href="https://ctftime.org/writeup/16030">manually</a> was complicated, but thankfully, I found <a href="https://unframework.github.io/dtmf-detect/#/grid">dtmf-detect</a> and was able to extract the tone to the following number sequence:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>33335555224400555544447777777788333666002222555566667777777733355559999
</code></pre></div></div>

<p>I then used an <a href="https://www.dcode.fr/multitap-abc-cipher">online decoder</a> to solve this <code class="language-plaintext highlighter-rouge">Multi-tap Cipher</code> and obtain the flag.</p>

<p><img src="../assets/201909_shecurity/TeelX_Dcode_MultiTap.PNG" alt="TeelX_Dcode_MultiTap" /></p>

<p><strong>Flag: FLAG LISTEN CLOSELY</strong></p>

<h3 id="puzzle-acsiing-for-a-change">[Puzzle] ACSIIng For A Change</h3>

<blockquote>
  <p>G 40 0 -11 -68 74 5 -13 -65 -1 91 -21 6 -11 6 -45 42 1 7 8 -19 18 -83 68 5 3 -3 -2 -2 9 6 -8 13 -89 68 5 10 -3 -11 7 -76 68 11 6 -19 18 -1 10</p>

  <p><em>Hint: If you know where you are then the next step tells you where to go.</em></p>
</blockquote>

<p>The challenge title was a rather obvious hint that ASCII table is involved someone or another. A quick revision, the numbers in ASCII table are how computers - who only understands numbers - interprets characters. With that in mind, I referenced the table to translate <code class="language-plaintext highlighter-rouge">G</code> into <code class="language-plaintext highlighter-rouge">71</code>.</p>

<p>Gambling on the assumption that numbers with <code class="language-plaintext highlighter-rouge">-</code> preceding the numbers are subtract operators, <code class="language-plaintext highlighter-rouge">70 + 40 = 111</code> would translate into <code class="language-plaintext highlighter-rouge">o</code>. Continuing with that train of thought would led to the flag!</p>

<p>Here’s a manual way of how I did it:</p>

<p><img src="../assets/201909_shecurity/ACSII4Change_flag.jpg" alt="ACSII4Change_flag" /></p>

<p><strong>Flag: {flag: deltas diligently dispel doubts}</strong></p>

<h3 id="puzzle-lets-remain-friends">[Puzzle] Let’s REMAIN friends</h3>

<blockquote>
  <p>Friends always give 0x100%</p>

  <p>….—–.-….-…. ..—.—-…..-…. -……—….-.—- ..—…–…——.—-. .—-….-…——…..- .——-…….—–..— —-.——-…….- ..—.——-…..–…– .——-..–…—..—-. ..—.—-…–…..—.. …–….–…. …—–..—-…— .——–.—–….-….. ..—…–….-.—-….- .—–….–…—–….. ..——……—–.</p>

  <p><a href="../assets/201909_shecurity/RemainFriends_MorseCode.jpg">MorseCode.png</a></p>
</blockquote>

<p><img src="../assets/201909_shecurity/RemainFriends_MorseCode.jpg" alt="RemainFriends_MorseCode" /></p>

<p>Using the Morse code numerals guide given, I inferred that I needed to split the given chunk of Morse into groups of five and convert them into ASCII text.</p>

<p>Parsed Morse:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>....- ----. -.... -....
..--- .---- ..... -....
-.... ..--- ....- .----
..--- ...-- ...-- ----. ----.
.---- ....- ...-- ----. ....-
.---- ---.. ..... ----- ..---
----. ----- --... ....-
..--- .---- ---.. ...-- ...--
.---- ---.. --... ---.. ----.
..--- .---- ...-- ..... ---..
...-- ....- -....
...-- ---.. ----. ..---
.---- ----. ----- ....- .....
..--- ...-- ....- .---- ....-
.---- -.... --... ----- .....
..--- ---.. ....- ----.
</code></pre></div></div>

<p>Converted result:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4966  2156  6241  23399  14394  18502  9074  21833  18789  21358  346  3892  19045  23414  16705  2849
</code></pre></div></div>

<p>Initially confused, I only thought of converting these numbers into <code class="language-plaintext highlighter-rouge">decimals</code> when I realized that decoding <code class="language-plaintext highlighter-rouge">0x100</code> from <code class="language-plaintext highlighter-rouge">hex</code> to <code class="language-plaintext highlighter-rouge">ascii</code> is impossible. Going by the challenge description of <code class="language-plaintext highlighter-rouge">REMIND</code>, I realized that this challenge has something to do with the divider operator – more specifically <code class="language-plaintext highlighter-rouge">modulo</code>.</p>

<p>Now that I know that, I then <code class="language-plaintext highlighter-rouge">modulo</code> all converted numbers by <code class="language-plaintext highlighter-rouge">256</code> individually obtaining:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>102 108 97 103 58 70 114 73 101 110 90 52 101 118 65 33
</code></pre></div></div>

<p>With an online <a href="https://tomeko.net/online_tools/dec_to_ascii.php?lang=en">decimals to ascii decoder</a>, I got the flag!</p>

<p><img src="../assets/201909_shecurity/RemainFriends_DecimalsToAscii.PNG" alt="RemainFriends_DecimalsToAscii" /></p>

<p><strong>Flag: FrIenZ4evA!</strong></p>

</div>



<div class="pagination">
  
    <a href="/bucketoftears/2019-10-17/bsides-toronto" class="left arrow">&#8592;</a>
  
  

  <a href="#" class="top">Top</a>
</div>
    </main>

    <footer>
  <span>
    &copy; <time datetime="2021-06-21 13:56:54 +0800">2021</time> . Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer>

  </body>
</html>
